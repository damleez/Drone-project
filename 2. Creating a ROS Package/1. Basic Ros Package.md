Basic Ros Package
===
### 1. Catkin package
- Catkinì€ ROSì˜ ë¹Œë“œ ì‹œìŠ¤í…œìœ¼ë¡œ ë³¼ ìˆ˜ ìˆê³  íŒ¨í‚¤ì§€ë“¤ì„ íš¨ìœ¨ì ìœ¼ë¡œ ë¹Œë“œí•˜ì—¬ ë‹¤ë¥¸ ìƒí™©ì—ì„œ ì‰½ê²Œ ì‚¬ìš©ë  ìˆ˜ ìˆë„ë¡ í•¨
- ì¡°ê±´
  - íŒ¨í‚¤ì§€ëŠ” ë°˜ë“œì‹œ catkinì„ ë”°ë¥´ëŠ” .xmlíŒŒì¼ì´ í•„ìš”
    - íŒ¨í‚¤ì§€.xml íŒŒì¼ì€ íŒ¨í‚¤ì§€ì— ëŒ€í•œ ë©”íƒ€ ì •ë³´ë¥¼ ì œê³µ (ë©”íƒ€ ì •ë³´ : ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì´ìš©í•˜ê¸° ìœ„í•´ ì„¤ëª…í•´ë†“ì€ ì •ë³´)
    - ë”°ë¼ì„œ ê°€ì¥ ë‹¨ìˆœí•œ íŒ¨í‚¤ì§€ì˜ í˜•íƒœëŠ” ì•„ë˜ì™€ ê°™ìŒ
    ```
    my_package/
    CMakeLists.txt
    package.xml
    ```
  - íŒ¨í‚¤ì§€ëŠ” ë°˜ë“œì‹œ catkinì„ ì‚¬ìš©í•˜ëŠ” CMakeLists.txt íŒŒì¼ì„ í¬í•¨í•˜ê³  ìˆì–´ì•¼ í•¨
  - ê°ê°ì˜ íŒ¨í‚¤ì§€ëŠ” ê°ê°ì˜ í´ë”ë¥¼ ê°–ê³  ìˆì–´ì•¼ í•¨
    - ë‹¤ìˆ˜ì˜ íŒ¨í‚¤ì§€ë“¤ì´ ê°™ì€ ê²½ë¡œë¥¼ ê³µìœ í•  ìˆ˜ ì—†ìŒ

<catkin workspaceì˜ í˜•íƒœ>

![image](https://user-images.githubusercontent.com/108650199/178921329-b03ac8e5-8af0-4cdd-9c75-c00518d1a814.png)

### 2. Creating a catkin package
> Reference : http://wiki.ros.org/ROS/Tutorials/CreatingPackage

##### 1. Creating a catkin package in workspace
```
# You should have created this in the Creating a Workspace Tutorial
$ cd ~/catkin_ws/src
```
##### 2. Package depends dependencies
- dependencies : std_msgs, rospy, roscpp
```
catkin_create_pkg beginner_tutorials std_msgs rospy roscpp
```
##### 3. Package contains a package.xml and a CMakeLists.txt
##### <package.xml>
> Reference : http://wiki.ros.org/catkin/package.xml
- 1. ê¸°ë³¸ êµ¬ì¡°
```
<package format="2">

</package>
```
- 2. í•„ìš”í•œ íƒœê·¸
```
<name> íŒ¨í‚¤ì§€ ì´ë¦„
<version> íŒ¨í‚¤ì§€ ë²„ì „ ë²ˆí˜¸(ì ìœ¼ë¡œ êµ¬ë¶„ëœ 3ê°œì˜ ì •ìˆ˜ì—¬ì•¼ í•¨)
<description> íŒ¨í‚¤ì§€ ë‚´ìš©ì— ê´€í•œ ì„¤ëª…
<maintainer> íŒ¨í‚¤ì§€ ìœ ì§€ ê´€ë¦¬í•˜ëŠ” ì‚¬ëŒ ì´ë¦„
<license> ì½”ë“œê°€ ë¦´ë¦¬ìŠ¤ ë˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ë¼ì´ì„ ìŠ¤(ex:GPL, BSD, ASL)
```
ex) foo_core package ì˜ˆì‹œ
  ```
  <package format="2">  : íŒ¨í‚¤ì§€.xmlì˜ ê¸°ë³¸ êµ¬ì¡° ì²˜ìŒ
  <name>foo_core</name> : íŒ¨í‚¤ì§€ ì´ë¦„ foo_core
  <version>1.2.4</version> : íŒ¨í‚¤ì§€ ë²„ì „ ë²ˆí˜¸
  <description> : íŒ¨í‚¤ì§€ ë‚´ìš©ì— ê´€í•œ ì„¤ëª…
  This package provides foo capability.
  </description> 
  <maintainer email="ivana@osrf.org">Ivana Bildbotz</maintainer> : íŒ¨ì§€ ìœ ì§€ ê´€ë¦¬ í•˜ëŠ” ì‚¬ëŒ ì´ë©”ì¼ê³¼ ì´ë¦„
  <license>BSD</license> : ì½”ë“œê°€ ë¦´ë¦¬ìŠ¤ ë˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ë¼ì´ì„ ìŠ¤
  </package> : íŒ¨í‚¤ì§€.xmlì˜ ê¸°ë³¸ êµ¬ì¡° ë§ˆì§€ë§‰
  ```
- 3. ì˜ì¡´ì„± (Dependencies)
- ìµœì†Œ íƒœê·¸ë¥¼ ê°€ì§„ íŒ¨í‚¤ì§€ ë©”ë‹ˆí˜ìŠ¤íŠ¸(=package.xml)ëŠ” ë‹¤ë¥¸ íŒ¨í‚¤ì§€ì— ëŒ€í•œ ì¢…ì†ì„±ì„ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©° íŒ¨í‚¤ì§€ì—ëŠ” 6ê°€ì§€ ìœ í˜•ì˜ ì¢…ì†ì„±ì´ ìˆì„ ìˆ˜ ìˆìŒ
  - <build_depend> Build Dependencies : íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œí•˜ëŠ” ë° í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ì§€ì •
  - <build_export_depend> Build Export Dependencies : íŒ¨í‚¤ì§€ì— ëŒ€í•´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¹Œë“œí•˜ëŠ” ë° í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ì§€ì •
  - <exec_depend> Execution Dependencies : íŒ¨í‚¤ì§€ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ë° í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ì§€ì •
  - <test_depend> Test Dependencies : ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì— ëŒ€í•œ ì¶”ê°€ ë¹Œë“œ ë˜ëŠ” ì‹¤í–‰ ì¢…ì†ì„±
  - <buildtool_depend> Build Tool Dependencies : íŒ¨í‚¤ì§€ê°€ ìì²´ì ìœ¼ë¡œ ë¹Œë“œí•˜ëŠ” ë° í•„ìš”í•œ ë¹Œë“œ ì‹œìŠ¤í…œ ë„êµ¬ë¥¼ ì§€ì •í•˜ë©° ì¼ë°˜ì ìœ¼ë¡œ í•„ìš”í•œ ìœ ì¼í•œ ë¹Œë“œ ë„êµ¬ëŠ” catkin
  - <doc_depend> Documentation Tool Dependencies : íŒ¨í‚¤ì§€ê°€ ë¬¸ì„œë¥¼ ìƒì„±í•˜ëŠ” ë° í•„ìš”í•œ ë¬¸ì„œ ë„êµ¬ë¥¼ ì§€ì •
  - ì´ì™¸ë¡œ, <depend> ëŠ” ì¢…ì†ì„±ì´ ë¹Œë“œ, ë‚´ë³´ë‚´ê¸° ë° ì‹¤í–‰ ì¢…ì†ì„±ì„ì„ ì§€ì •í•˜ë©° ê°€ì¥ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì¢…ì†ì„± íƒœê·¸

- ex ) foo_core package.xml  
```
<package format="2">
<name>foo_core</name>
<version>1.2.4</version>
<description>
  This package provides foo capability.
</description>
<maintainer email="ivana@willowgarage.com">Ivana Bildbotz</maintainer>
<license>BSD</license>  //ì—¬ê¸°ê¹Œì§€ ê¸°ë³¸ì ìœ¼ë¡œ ë“¤ì–´ê°€ì•¼ í•  ëª©

<url>http://ros.org/wiki/foo_core</url>
<author>Ivana Bildbotz</author>

<buildtool_depend>catkin</buildtool_depend>

<depend>roscpp</depend>
<depend>std_msgs</depend>
  
<build_depend>message_generation</build_depend>

<exec_depend>message_runtime</exec_depend>
<exec_depend>rospy</exec_depend>

<test_depend>python-mock</test_depend>

<doc_depend>doxygen</doc_depend>
</package>  
```

###### <Cmakelists.txt>
> Reference : http://wiki.ros.org/catkin/CMakeLists.txt
  > https://gist.github.com/dongbum/d1d49e38a20f9cf52ea39f9ce2702160
- 1. CmakeList structure
```
1. í•„ìˆ˜ CMake ë²„ì „ Required CMake Version (cmake_minimum_required)
2. íŒ¨í‚¤ì§€ ì´ë¦„ Package Name (project())
3. ë¹Œë“œì— í•„ìš”í•œ ë‹¤ë¥¸ CMake/Catkin íŒ¨í‚¤ì§€ ì°¾ê¸° Find other CMake/Catkin packages needed for build (find_package())
4. Python ëª¨ë“ˆ ì§€ì› í™œì„±í™” Enable Python module support (catkin_python_setup())
ğŸ’¥ï¸ 5. ë©”ì‹œì§€/ì„œë¹„ìŠ¤/ì•¡ì…˜ ìƒì„±ê¸° Message/Service/Action Generators (add_message_files(), add_service_files(), add_action_files()) ğŸ’¥ï¸
ğŸ’¥ï¸ 6. ë©”ì‹œì§€/ì„œë¹„ìŠ¤/ì•¡ì…˜ ìƒì„± í˜¸ì¶œ Invoke message/service/action generation (generate_messages()) ğŸ’¥ï¸
7. íŒ¨í‚¤ì§€ ë¹Œë“œ ì •ë³´ ë‚´ë³´ë‚´ê¸° ì§€ì • Specify package build info export (catkin_package())
8. ë¹Œë“œí•  ë¼ì´ë¸ŒëŸ¬ë¦¬/ì‹¤í–‰ íŒŒì¼ Libraries/Executables to build (add_library()/add_executable()/target_link_libraries())
9. ë¹Œë“œ í…ŒìŠ¤íŠ¸ Tests to build (catkin_add_gtest())
10. ì„¤ì¹˜ ê·œì¹™ Install rules (install()) 
```
- í•„ìˆ˜ CMake ë²„ì „
  - Catkinì€ ë²„ì „ 2.8.3ì´ìƒì´ í•„ìš”
- íŒ¨í‚¤ì§€ ì´ë¦„
- ì¢…ì† CMake íŒ¨í‚¤ì§€ ì°¾ê¸°
  ```
  find_package(catkin REQUIRED)
  ```
  - find packageë¥¼ í†µí•´ CMakeì—ì„œ íŒ¨í‚¤ì§€ë¥¼ ì°¾ìœ¼ë©´ ë°œê²¬ëœ íŒ¨í‚¤ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” ì—¬ëŸ¬ CMake í™˜ê²½ ë³€ìˆ˜ê°€ ìƒì„±
  - í™˜ê²½ ë³€ìˆ˜ëŠ” í—¤ë” íŒŒì¼ì˜ ìœ„ì¹˜, ì†ŒìŠ¤ íŒŒì¼ì˜ ìœ„ì¹˜, íŒ¨í‚¤ì§€ê°€ ì˜ì¡´í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ê²½ë¡œë¥¼ ì„¤ëª…
    - <NAME>_FOUND : ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì°¾ìœ¼ë©´ trueë¡œ ì„¤ì •í•˜ê³  ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ falseë¡œ ì„¤ì •
    - <NAME>_INCLUDE_DIRS or <NAME>_INCLUDES : íŒ¨í‚¤ì§€ì—ì„œ ë‚´ë³´ë‚¸ ê²½ë¡œ
    - <NAME>_LIBRARIES or <NAME>_LIBS : íŒ¨í‚¤ì§€ì—ì„œ ë‚´ë³´ë‚¸ ë¼ì´ë¸ŒëŸ¬ë¦¬
    - <NAME>_DEFINITIONS : ? 
- 2. catkin_package() 
  - add_library() or add_executable()ë¥¼ ì„ ì–¸í•  ë•Œ ğŸ’¥ï¸ê¼­ğŸ’¥ ë¶ˆëŸ¬ì•¼í•˜ëŠ” ê²ƒ
    - INCLUDE_DIRS : ë‚´ë³´ë‚¸ íŒ¨í‚¤ì§€ì˜ í¬í•¨ ê²½ë¡œ
    - LIBRARIES : í”„ë¡œì íŠ¸ì—ì„œ ë‚´ë³´ë‚¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ 
    - ATKIN_DEPENDS : ì´ í”„ë¡œì íŠ¸ê°€ ì˜ì¡´í•˜ëŠ” ë‹¤ë¥¸ catkin í”„ë¡œì íŠ¸ 
    - DEPENDS : ì´ í”„ë¡œì íŠ¸ê°€ ì˜ì¡´í•˜ëŠ” ë¹„ catkin CMake í”„ë¡œì íŠ¸
    - CFG_EXTRAS : ì¶”ê°€ êµ¬ì„± ì˜µì…˜ 
  - ex)
  ```
  catkin_package( 
  INCLUDE_DIRS include : íŒ¨í‚¤ì§€ í´ë” ë‚´ì˜ 'include'í´ë”ê°€ ë‚´ë³´ë‚¸ í—¤ë”ê°€ ìˆëŠ” ìœ„ì¹˜
  LIBRARIES ${PROJECT_NAME} : Cmakeí™˜ê²½ ë³€ìˆ˜ project nameì€ project() í•¨ìˆ˜ì— ì „ë‹¬í•œ ê²ƒìœ¼ë¡œ í‰ê°€ë˜ë©° ì´ ê²½ìš°ëŠ” 'my package'
  CATKIN_DEPENDS roscpp nodelet : roscpp+nodeletì€ ì´ íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œ/ì‹¤í–‰í•˜ê¸° ìœ„í•´ ìˆì–´ì•¼ í•˜ëŠ” íŒ¨í‚¤ì§€
  DEPENDS eigen opencv) : eigen+opencv ëŠ” ì´ íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œ/ì‹¤í–‰í•˜ê¸° ìœ„í•´ ìˆì–´ì•¼ í•˜ëŠ” ì‹œìŠ¤í…œ ì¢…ì†ì„±
  ```
- 3. Build Target ì§€ì •
  - Executable Target : ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” í”„ë¡œê·¸ë¨ 
  - Library Target : ë¹Œë“œ ë°/ë˜ëŠ” ëŸ°íƒ€ì„ ì‹œ ì‹¤í–‰ ê°€ëŠ¥í•œ ëŒ€ìƒì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ 
  â‘  Target(ëŒ€ìƒ ì´ë¦„) ì§€ì • 
  â‘¡ ì‚¬ìš©ì ì •ì˜ ì¶œë ¥ ë””ë ‰í† ë¦¬ 
  â‘¢ ê²½ë¡œ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬ ê²½ë¡œ í¬í•¨ 
  â‘£ ì‹¤í–‰ ëŒ€ìƒ 
  â‘¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ ëŒ€ìƒ 
  â‘¥ target_link_libraries 
 
##### 4. Start package
```
catkin_create_pkg <package_name> [depend1] [depend2] [depend3]
```
##### 5. Building a catkin worspace and sourcing
```
cw
catkin build
. ~/catkin_ws/devel/setup.bash
```
##### 6. Check package 
- Dependencies í™•ì¸
  - ì´ë¯¸ ìœ„ì—ì„œ std msg/rospy/rosdep ë°›ì•˜ì§€ë§Œ ë‹¤ì‹œ í•œ ë²ˆ í™•ì¸í•˜ê¸° ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ ëª…ë ¹ì–´ë¡œ í™•ì¸
```
rospack depends1 beginner_tutorials 
```
- cat ëª…ë ¹ì–´ë¥¼ í†µí•´ package.xml íŒŒì¼ ë‚´ìš© í™•ì¸
```
roscd beginner_tutorials
$ cat package.xml
```
- ì‹¤í–‰ í™•ì¸ : package.xml í™•ì¸í•˜ë©´ ìœ„ì˜ dependencies ê¹ ê²ƒë“¤ì´ xmlíŒŒì¼ì— ì €ì¥ë¨  
```
  <package format="2">
...
  <buildtool_depend>catkin</buildtool_depend>
  <build_depend>roscpp</build_depend>
  <build_depend>rospy</build_depend>
  <build_depend>std_msgs</build_depend>
...
</package>
```
##### 7. ê°„ì ‘ ì˜ì¡´ì„±
- ë§ì€ ê²½ìš°, ì˜ì¡´ì„±ì€ ìì‹  ê³ ìœ ì˜ ì˜ì¡´ì„±ë“¤ì„ ê°€ì§€ì§€ë§Œ 'rospy'ëŠ” ë‹¤ë¥¸ ì˜ì¡´ì„±ë“¤ì„ ê°€ì§
```
rospack depends1 rospy
```
- rospy ì˜ì¡´ì„±ë“¤ í™•ì¸
```
genpy
roscpp
rosgraph
rosgraph_msgs
roslib
std_msgs
```
- ë¿ ë§Œ ì•„ë‹ˆë¼, íŒ¨í‚¤ì§€ëŠ” ë§ì€ ê°„ì ‘ ì˜ì¡´ì„±ë“¤ì„ ê°€ì§€ë©° 'rospack'ì€ ëª¨ë“  ì¤‘ì²© ì¢…ì†ì„±ì„ ì¬ê·€ì ìœ¼ë¡œ ê²°ì •
- rospackì„ í†µí•´ ë§ì€ ê°„ì ‘ ì˜ì¡´ì„±ë“¤ í™•ì¸ (ìœ„ì™€ ë‹¤ë¥¸ ì ì€ depends1ê³¼ depend ì´ ëª…ë ¹ì–´ê°€ ë‹¤ë¦„)
- depend : depends1ì´ ì•„ë‹Œ depends ì˜µì…˜ ì‚¬ìš© ì‹œ ì¢…ì†ëœ íŒ¨í‚¤ì§€ë“¤ì— í•˜ìœ„ ì¢…ì†ëœ ê²ƒë“¤ê¹Œì§€ ë³´ì—¬ì¤Œ
```
rospack depends beginner_tutorials
```
